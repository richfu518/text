{% extends 'base.html' %}

{% block title %}
    资产列表 - {{ block.super }}
{% endblock %}

{% block content %}
    <h1 class="my-4">资产列表</h1>
    <form method="get" class="form-inline mb-3">
        <input type="text" name="search" class="form-control mr-sm-2" placeholder="搜索资产" value="{{ request.GET.search }}">
        <button type="submit" class="btn btn-outline-primary my-2 my-sm-0">搜索</button>
    </form>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>资产名称</th>
                <th>资产类型</th>
                <th>采购日期</th>
                <th>价值</th>
                <th>分类</th>
                <th>状态</th>
                <th>操作</th>
                <th>图片</th>
            </tr>
        </thead>
        <tbody>
            {% for asset in object_list %}
            <tr>
                <td>{{ asset.name }}</td>
                <td>{{ asset.asset_type }}</td>
                <td>{{ asset.purchase_date }}</td>
                <td>{{ asset.value }}</td>
                <td>{{ asset.category.name }}</td>
                <td>{{ asset.get_status_display }}</td>
                <td>
                    {% if perms.asset_management.change_asset %}
                        <a href="{% url 'assets:asset_update' asset.pk %}" class="btn btn-sm btn-outline-primary">编辑</a >
                    {% endif %}
                    {% if perms.asset_management.delete_asset %}
                        <a href="{% url 'assets:asset_delete' asset.pk %}" class="btn btn-sm btn-outline-danger">删除</a >
                    {% endif %}
                    {% if perms.asset_management.add_assetassignment %}
                        <a href="{% url 'assets:asset_assign' asset.pk %}" class="btn btn-sm btn-outline-success">分配</a >
                    {% endif %}
                </td>
                <td><img src="{{ asset.image.url }}" alt="{{ asset.name }}" width="100" height="100"></td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center">没有找到匹配的资产。</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="pagination">
        <span class="step-links">
            {% if page_obj.has_previous %}
                <a href="?page=1{% if request.GET.search %}&search={{ request.GET.search }}{%  endif %}" class="btn btn-outline-secondary">&laquo; 首页</a >
                <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="btn btn-outline-secondary">上一页</a >
            {% endif %}
        </span>
    </div>
{% endblock %}

